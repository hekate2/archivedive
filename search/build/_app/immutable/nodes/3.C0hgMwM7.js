import{a as $,t as P}from"../chunks/disclose-version.k64xnaYB.js";import{i as J}from"../chunks/legacy.B1B-B5Xr.js";import{p as O,a as Q,d as a,g as t,f as V,t as T,e as b,c as o,s as n,r as e}from"../chunks/runtime.BhApFx9Z.js";import{e as y,s as q}from"../chunks/render.DUQkgiJu.js";import{o as W,i as X}from"../chunks/index-client.BNVBoJms.js";import{b as Y,e as Z,r as tt,i as st,s as L}from"../chunks/input.B9bdTJuK.js";import{p as et}from"../chunks/entry.CvtjxG6G.js";var at=P('<li class="result svelte-7qspod"><a class="site-title svelte-7qspod"> </a> <a class="site-link svelte-7qspod"> </a> <p class="svelte-7qspod"> </p></li>'),ot=P('<p id="results-count" class="svelte-7qspod"> </p> <ul id="results" class="svelte-7qspod"></ul> <div id="button-holder" class="svelte-7qspod"><button class="svelte-7qspod">Previous Page</button> <div id="chronology" class="svelte-7qspod"><p id="current-pg" class="svelte-7qspod"> </p></div> <button class="svelte-7qspod">Next Page</button></div>',1),rt=P("<p>No results found.</p>"),lt=P('<main class="svelte-7qspod"><div id="search-bar" class="svelte-7qspod"><a href="/" class="svelte-7qspod"><h1 class="svelte-7qspod">AD</h1></a> <input type="text" placeholder="Enter a search query" class="svelte-7qspod"> <button id="search-ifbutton" class="svelte-7qspod">Search!</button></div> <!></main>');function ht(A,C){O(C,!1);let r=b(""),c=b(0),w=b([]),E=b(0),m=b(0);const M=new Map;W(()=>{const s=new URLSearchParams(window.location.search);a(r,s.get("q")||""),t(r)&&f(t(r),t(c))});async function f(s,l=0){console.log("searching");try{if(!s||s.length===0)throw new Error("No search query provided");const i=`${s}_${l}`;if(M.has(i)){const h=M.get(i);a(w,h.data),a(E,h.time),a(m,h.total),a(c,l);return}const N=Date.now(),p=await fetch(`/api/search?q=${encodeURIComponent(s)}&p=${l}`);if(!p.ok)throw new Error(await p.text());const d=await p.json(),v=Date.now()-N;a(w,d.results),a(m,d.num_results),a(E,v),a(c,l),M.set(i,{data:d.results,time:v,total:d.num_results});const u=new URL(window.location.href);u.searchParams.set("q",s),et(u)}catch(i){console.error(i)}}J();var R=lt(),D=o(R),g=n(o(D),2);tt(g);var I=n(g,2);e(D);var K=n(D,2);X(K,()=>t(w).length>0,s=>{var l=ot(),i=V(l),N=o(i);e(i);var p=n(i,2);Z(p,5,()=>t(w),st,(B,_)=>{var S=at(),x=o(S),F=o(x,!0);e(x);var k=n(x,2),G=o(k,!0);e(k);var j=n(k,2),H=o(j,!0);e(j),e(S),T(()=>{L(x,"href",t(_)[1]),q(F,t(_)[0]),L(k,"href",t(_)[1]),q(G,t(_)[1]),q(H,t(_)[2])}),$(B,S)}),e(p);var d=n(p,2),v=o(d),u=n(v,2),h=o(u),z=o(h);T(()=>q(z,`${t(c)+1}/${Math.max(1,Math.floor(t(m)/10))??""}`)),e(h),e(u);var U=n(u,2);e(d),T(()=>{q(N,`${t(m)??""} results found in ${t(E)??""}ms`),v.disabled=t(c)<=0,U.disabled=(t(c)+1)*10>=t(m)}),y("click",v,()=>f(t(r),t(c)-1)),y("click",U,()=>f(t(r),t(c)+1)),$(s,l)},s=>{var l=rt();$(s,l)}),e(R),Y(g,()=>t(r),s=>a(r,s)),y("keydown",g,s=>s.key==="Enter"&&f(t(r),0)),y("click",I,()=>f(t(r))),$(A,R),Q()}export{ht as component};
