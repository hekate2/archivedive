import{a as g,t as k,c as V}from"../chunks/disclose-version.BRXAotLx.js";import"../chunks/legacy.ErBfe9UC.js";import{p as W,j as X,q as e,g as t,i as A,t as T,v as f,k as l,s as v,l as r}from"../chunks/runtime.C-3Um6sS.js";import{e as R,s as x}from"../chunks/render.DnDt8jo3.js";import{o as Y,i as C}from"../chunks/index-client.CqXEjBzy.js";import{b as Z,e as tt,r as st,i as et,s as I}from"../chunks/input.wpQbG6Sw.js";import{i as at}from"../chunks/lifecycle.CPlGSPMN.js";import{p as nt}from"../chunks/entry.ouxUgqOH.js";var rt=k('<li class="result svelte-n6nvsg"><a class="site-title svelte-n6nvsg"> </a> <a class="site-link svelte-n6nvsg"> </a> <p class="svelte-n6nvsg"> </p></li>'),ot=k('<p id="results-count" class="svelte-n6nvsg"> </p> <ul id="results" class="svelte-n6nvsg"></ul> <div id="button-holder" class="svelte-n6nvsg"><button class="svelte-n6nvsg">Previous Page</button> <div id="chronology" class="svelte-n6nvsg"><p id="current-pg" class="svelte-n6nvsg"> </p></div> <button class="svelte-n6nvsg">Next Page</button></div>',1),lt=k('<img src="loading.gif" id="loading" alt="loading icon" class="svelte-n6nvsg">'),it=k("<p>No results found.</p>"),vt=k('<main class="svelte-n6nvsg"><div id="search-bar" class="svelte-n6nvsg"><a href="/" class="svelte-n6nvsg"><h1 class="svelte-n6nvsg">AD</h1></a> <input type="text" placeholder="Enter a search query" class="svelte-n6nvsg"> <button id="search-ifbutton" class="svelte-n6nvsg">Search!</button></div> <!></main>');function _t(K,z){W(z,!1);let i=f(""),c=f(0),$=f([]),j=f(0),_=f(0),y=f(!1);const q=new Map;Y(()=>{const s=new URLSearchParams(window.location.search);e(i,s.get("q")||""),t(i)&&b(t(i),t(c))});async function b(s,o=0){console.log("searching");try{if(!s||s.length===0)throw new Error("No search query provided");e(y,!0);const a=`${s}_${o}`;if(q.has(a)){const h=q.get(a);e($,h.data),e(j,h.time),e(_,h.total),e(c,o);return}const d=Date.now(),n=await fetch(`/api/search?q=${encodeURIComponent(s)}&p=${o}`);if(!n.ok)throw new Error(await n.text());const u=await n.json(),p=Date.now()-d;e(y,!1),e($,u.results),e(_,u.num_results),e(j,p),e(c,o),q.set(a,{data:u.results,time:p,total:u.num_results});const m=new URL(window.location.href);m.searchParams.set("q",s),nt(m)}catch(a){e(y,!1),console.error(a)}}at();var D=vt(),N=l(D),P=v(l(N),2);st(P);var B=v(P,2);r(N);var F=v(N,2);C(F,()=>t($).length>0,s=>{var o=ot(),a=A(o),d=l(a);r(a);var n=v(a,2);tt(n,5,()=>t($),et,(H,w)=>{var S=rt(),E=l(S),J=l(E,!0);r(E);var M=v(E,2),O=l(M,!0);r(M);var L=v(M,2),Q=l(L,!0);r(L),r(S),T(()=>{I(E,"href",t(w)[1]),x(J,t(w)[0]),I(M,"href",t(w)[1]),x(O,t(w)[1]),x(Q,t(w)[2])}),g(H,S)}),r(n);var u=v(n,2),p=l(u),m=v(p,2),h=l(m),G=l(h);T(()=>x(G,`${t(c)+1}/${Math.max(1,Math.floor(t(_)/10))??""}`)),r(h),r(m);var U=v(m,2);r(u),T(()=>{x(d,`${t(_)??""} results found in ${t(j)??""}ms`),p.disabled=t(c)<=0,U.disabled=(t(c)+1)*10>=t(_)}),R("click",p,()=>b(t(i),t(c)-1)),R("click",U,()=>b(t(i),t(c)+1)),g(s,o)},s=>{var o=V(),a=A(o);C(a,()=>t(y),d=>{var n=lt();g(d,n)},d=>{var n=it();g(d,n)},!0),g(s,o)}),r(D),Z(P,()=>t(i),s=>e(i,s)),R("keydown",P,s=>s.key==="Enter"&&b(t(i),0)),R("click",B,()=>b(t(i))),g(K,D),X()}export{_t as component};
