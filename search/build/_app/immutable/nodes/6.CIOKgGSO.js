import{a as g,t as k,c as V}from"../chunks/disclose-version.BRXAotLx.js";import"../chunks/legacy.ErBfe9UC.js";import{p as W,j as X,q as o,g as t,i as A,t as T,v as w,k as l,s as v,l as n}from"../chunks/runtime.C-3Um6sS.js";import{e as M,s as x}from"../chunks/render.DnDt8jo3.js";import{o as Y,i as C}from"../chunks/index-client.CqXEjBzy.js";import{b as Z,e as tt,r as st,i as et,s as I}from"../chunks/input.wpQbG6Sw.js";import{i as at}from"../chunks/lifecycle.CPlGSPMN.js";import{p as nt}from"../chunks/entry.BB1RtMm2.js";var rt=k('<li class="result svelte-n6nvsg"><a class="site-title svelte-n6nvsg"> </a> <a class="site-link svelte-n6nvsg"> </a> <p class="svelte-n6nvsg"> </p></li>'),ot=k('<p id="results-count" class="svelte-n6nvsg"> </p> <ul id="results" class="svelte-n6nvsg"></ul> <div id="button-holder" class="svelte-n6nvsg"><button class="svelte-n6nvsg">Previous Page</button> <div id="chronology" class="svelte-n6nvsg"><p id="current-pg" class="svelte-n6nvsg"> </p></div> <button class="svelte-n6nvsg">Next Page</button></div>',1),lt=k('<img src="loading.gif" id="loading" alt="loading icon" class="svelte-n6nvsg">'),it=k("<p>No results found.</p>"),vt=k('<main class="svelte-n6nvsg"><div id="search-bar" class="svelte-n6nvsg"><a href="/" class="svelte-n6nvsg"><h1 class="svelte-n6nvsg">AD</h1></a> <input type="text" placeholder="Enter a search query" class="svelte-n6nvsg"> <button id="search-ifbutton" class="svelte-n6nvsg">Search!</button></div> <!></main>');function _t(K,z){W(z,!1);let i=w(""),c=w(0),$=w([]),R=w(0),f=w(0),j=!1;const q=new Map;Y(()=>{const s=new URLSearchParams(window.location.search);o(i,s.get("q")||""),t(i)&&_(t(i),t(c))});async function _(s,r=0){console.log("searching");try{if(!s||s.length===0)throw new Error("No search query provided");j=!0;const e=`${s}_${r}`;if(q.has(e)){const h=q.get(e);o($,h.data),o(R,h.time),o(f,h.total),o(c,r);return}const d=Date.now(),a=await fetch(`/api/search?q=${encodeURIComponent(s)}&p=${r}`);if(!a.ok)throw new Error(await a.text());const u=await a.json(),p=Date.now()-d;j=!1,o($,u.results),o(f,u.num_results),o(R,p),o(c,r),q.set(e,{data:u.results,time:p,total:u.num_results});const m=new URL(window.location.href);m.searchParams.set("q",s),nt(m)}catch(e){j=!1,console.error(e)}}at();var D=vt(),N=l(D),y=v(l(N),2);st(y);var B=v(y,2);n(N);var F=v(N,2);C(F,()=>t($).length>0,s=>{var r=ot(),e=A(r),d=l(e);n(e);var a=v(e,2);tt(a,5,()=>t($),et,(H,b)=>{var S=rt(),P=l(S),J=l(P,!0);n(P);var E=v(P,2),O=l(E,!0);n(E);var L=v(E,2),Q=l(L,!0);n(L),n(S),T(()=>{I(P,"href",t(b)[1]),x(J,t(b)[0]),I(E,"href",t(b)[1]),x(O,t(b)[1]),x(Q,t(b)[2])}),g(H,S)}),n(a);var u=v(a,2),p=l(u),m=v(p,2),h=l(m),G=l(h);T(()=>x(G,`${t(c)+1}/${Math.max(1,Math.floor(t(f)/10))??""}`)),n(h),n(m);var U=v(m,2);n(u),T(()=>{x(d,`${t(f)??""} results found in ${t(R)??""}ms`),p.disabled=t(c)<=0,U.disabled=(t(c)+1)*10>=t(f)}),M("click",p,()=>_(t(i),t(c)-1)),M("click",U,()=>_(t(i),t(c)+1)),g(s,r)},s=>{var r=V(),e=A(r);C(e,()=>!0,d=>{var a=lt();g(d,a)},d=>{var a=it();g(d,a)},!0),g(s,r)}),n(D),Z(y,()=>t(i),s=>o(i,s)),M("keydown",y,s=>s.key==="Enter"&&_(t(i),0)),M("click",B,()=>_(t(i))),g(K,D),X()}export{_t as component};
